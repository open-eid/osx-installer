<?xml version="1.0" encoding="utf-8" standalone="no"?>
<!--
https://developer.apple.com/library/mac/documentation/DeveloperTools/Reference/DistributionDefinitionRef/
https://developer.apple.com/library/mac/documentation/DeveloperTools/Reference/InstallerJavaScriptRef/
-->
<installer-gui-script minSpecVersion="2">
    <title>SU_TITLE</title>
    <allowed-os-versions>
        <os-version min="10.7"/>
    </allowed-os-versions>
    <options customize="allow" require-scripts="false" rootVolumeOnly="true" hostArchitectures="x86_64"/>
    <!--domains enable_anywhere="false" enable_currentUserHome="false" enable_localSystem="true"/-->
    <background file="background.png"/>
    <license file="License.txt"/>
    <welcome language="en" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 You will be guided through the steps necessary to install this software.}]]></welcome>
    <welcome language="et" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 J\'e4rgnevad juhised tarkvara installeerimiseks.}]]></welcome>
    <welcome language="ru" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 \uc0\u1042 \u1072 \u1084  \u1073 \u1091 \u1076 \u1091 \u1090  \u1087 \u1088 \u1077 \u1076 \u1083 \u1086 \u1078 \u1077 \u1085 \u1099  \u1096 \u1072 \u1075 \u1080  \u1087 \u1086  \u1091 \u1089 \u1090 \u1072 \u1085 \u1086 \u1074 \u1082 \u1077  \u1076 \u1072 \u1085 \u1085 \u1086 \u1075 \u1086  \u1055 \u1054.}]]></welcome>
    <conclusion language="en" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs28 \cf0 \
Changelog: {\field{\*\fldinst{HYPERLINK "http://www.id.ee/eng/changelog"}}{\fldrslt http://www.id.ee/eng/changelog}}
\b \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\b0\fs26 \cf0 \
Additional software is available in the Mac App Store:\
* DigiDoc3 client for signing with ID-card and Mobile-ID\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/digidoc3client"}}{\fldrslt \cf0 http://appstore.com/mac/ria/digidoc3client}}\
* ID-card utility\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/idcardutility"}}{\fldrslt \cf0 http://appstore.com/mac/ria/idcardutility}}}]]></conclusion>
    <conclusion language="et" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs26 \cf0 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\fs28 \cf0 Muudatuste loetelu: {\field{\*\fldinst{HYPERLINK "http://www.id.ee/changelog"}}{\fldrslt http://www.id.ee/changelog}}
\b \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\b0\fs26 \cf0 \
Lisaks tuleb Mac App Store'ist arvutisse paigaldada:\
* DigiDoc3 klient ID-kaardi ja Mobiil-IDga allkirjastamiseks\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/digidoc3client"}}{\fldrslt \cf0 http://appstore.com/mac/ria/digidoc3client}}\
* ID-kaardi haldusvahend\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/idcardutility"}}{\fldrslt \cf0 http://appstore.com/mac/ria/idcardutility}}}]]></conclusion>
    <conclusion language="ru" mime-type="text/rtf"><![CDATA[{\rtf1\ansi\ansicpg1252\cocoartf1187\cocoasubrtf400
{\fonttbl\f0\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;}
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\f0\fs28 \cf0 \
\uc0\u1046 \u1091 \u1088 \u1085 \u1072 \u1083  \u1080 \u1079 \u1084 \u1077 \u1085 \u1077 \u1085 \u1080 \u1081 : {\field{\*\fldinst{HYPERLINK "http://www.id.ee/rus/changelog"}}{\fldrslt http://www.id.ee/rus/changelog}}
\b \
\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural

\b0\fs26 \cf0 \
\uc0\u1053 \u1077 \u1086 \u1073 \u1093 \u1086 \u1076 \u1080 \u1084 \u1086  \u1090 \u1072 \u1082 \u1078 \u1077  \u1079 \u1072 \u1075 \u1088 \u1091 \u1079 \u1080 \u1090 \u1100  \u1080 \u1079  \u1084 \u1072 \u1075 \u1072 \u1079 \u1080 \u1085 \u1072  \u1087 \u1088 \u1080 \u1083 \u1086 \u1078 \u1077 \u1085 \u1080 \u1081  Mac App Store \u1080  \u1091 \u1089 \u1090 \u1072 \u1085 \u1086 \u1074 \u1080 \u1090 \u1100  \u1085 \u1072  \u1082 \u1086 \u1084 \u1087 \u1100 \u1102 \u1090 \u1077 \u1088:\
* DigiDoc3 \uc0\u1082 \u1083 \u1080 \u1077 \u1085 \u1090  \u1076 \u1083 \u1103  \u1087 \u1086 \u1076 \u1087 \u1080 \u1089 \u1099 \u1074 \u1072 \u1085 \u1080 \u1103  \u1076 \u1086 \u1082 \u1091 \u1084 \u1077 \u1085 \u1090 \u1086 \u1074  \u1089  ID-\u1082 \u1072 \u1088 \u1090 \u1086 \u1081  \u1080  Mobiil-ID\
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/digidoc3client"}}{\fldrslt \cf0 http://appstore.com/mac/ria/digidoc3client}}\
* \uc0\u1055 \u1088 \u1086 \u1075 \u1088 \u1072 \u1084 \u1084 \u1091  \u1091 \u1087 \u1088 \u1072 \u1074 \u1083 \u1077 \u1085 \u1080 \u1103  ID-\u1082 \u1072 \u1088 \u1090 \u1086 \u1081 \
\pard\tx560\tx1120\tx1680\tx2240\tx2800\tx3360\tx3920\tx4480\tx5040\tx5600\tx6160\tx6720\pardirnatural
{\field{\*\fldinst{HYPERLINK "http://appstore.com/mac/ria/idcardutility"}}{\fldrslt \cf0 http://appstore.com/mac/ria/idcardutility}}}]]></conclusion>
    <localization>
        <strings language="en">
<![CDATA[
"SU_TITLE" = "eID Software";
"SU_ERROR" = "Error";
"SU_10103" = "OS X 10.10 must be serivce pack 3 or newer.";
"SU_BASE" = "Base components";
"SU_SAFARI" = "Safari browser signing support";
"SU_FIREFOX" = "Firefox browser signing and authentication support";
"SU_CHROME" = "Chrome browser signing support";
"SU_DRIVERSNEW" = "Estonian ID-card support, OS X 10.10 or newer";
"SU_DRIVERSOLD" = "Estonian ID-card support, OS X 10.9";
]]>
        </strings>
        <strings language="et">
<![CDATA[
"SU_TITLE" = "eID tarkvara";
"SU_ERROR" = "Viga";
"SU_10103" = "OS X peab olema 10.10.3 või uuem.";
"SU_BASE" = "Baas komponendid";
"SU_SAFARI" = "Safari allkirjastamise tugi";
"SU_FIREFOX" = "Firefoxi allkirjastamise ja autentimise tugi";
"SU_CHROME" = "Chrome'i allkirjastamise tugi";
"SU_DRIVERSNEW" = "Eesti ID-kaardi tugi, al. OS X 10.10";
"SU_DRIVERSOLD" = "Eesti ID-kaardi tugi, OS X 10.9";
]]>
        </strings>
        <strings language="ru">
<![CDATA[
"SU_TITLE" = "eID Software";
"SU_ERROR" = "Error";
"SU_10103" = "OS X 10.10 must be serivce pack 3 or newer.";
"SU_BASE" = "Base components";
"SU_SAFARI" = "Поддержка подпис. в Safari";
"SU_FIREFOX" = "Поддержка подпис. и аутентиф. в Firefox";
"SU_CHROME" = "Поддержка подпис. в Chrome";
"SU_DRIVERSNEW" = "Поддержка эстонской ID-карты, OS X 10.10 и выше";
"SU_DRIVERSOLD" = "Поддержка эстонской ID-карты, OS X 10.9";
]]>
        </strings>
    </localization>
    <installation-check script="pm_install_check();"/>
    <script>
<![CDATA[
function pm_install_check() {
  if(system.compareVersions(system.version.ProductVersion, '10.10.0') >= 0 &&
     system.compareVersions(system.version.ProductVersion, '10.10.3') < 0) {
    my.result.title = system.localizedString('SU_ERROR');
    my.result.message = system.localizedString('SU_10103');
    my.result.type = 'Fatal';
    return false;
  }
  return true;
}

function pm_safari_selected() {
  return my.target.receiptForIdentifier("ee.ria.open-eid") == null ||
    my.target.receiptForIdentifier("ee.ria.firefox-token-signing") != null;
}

function pm_firefox_selected() {
  return my.target.receiptForIdentifier("ee.ria.open-eid") == null ||
    my.target.receiptForIdentifier("ee.ria.firefox-pkcs11-loader") != null;
}

function pm_chrome_selected() {
  return my.target.receiptForIdentifier("ee.ria.open-eid") == null ||
    my.target.receiptForIdentifier("ee.ria.chrome-token-signing") != null;
}

function pm_drivers1010_selected() {
  return (my.target.receiptForIdentifier("ee.ria.open-eid") == null &&
    system.compareVersions(system.version.ProductVersion, '10.10') >= 0) ||
    my.target.receiptForIdentifier("ee.ria.esteid-tokend") != null;
}

function pm_driversold_selected() {
  return (my.target.receiptForIdentifier("ee.ria.open-eid") == null &&
    system.compareVersions(system.version.ProductVersion, '10.10') < 0) ||
    my.target.receiptForIdentifier("ee.ria.esteid-tokend-old") != null;
}
function pm_drivers1010_enabled() {
  return system.compareVersions(system.version.ProductVersion, '10.10') >= 0;
}

function pm_driversold_enabled() {
  return system.compareVersions(system.version.ProductVersion, '10.10') < 0;
}
]]>
    </script>
    <choices-outline>
        <line choice="default"/>
        <line choice="safari"/>
        <line choice="firefox"/>
        <line choice="chrome"/>
        <line choice="drivers1010"/>
        <line choice="driversold"/>
    </choices-outline>
    <choice id="default" title="SU_BASE" start_enabled="false" visible="false">
        <pkg-ref id="ee.ria.updater">updater.pkg</pkg-ref>
        <pkg-ref id="ee.ria.open-eid">Open-EID.pkg</pkg-ref>
    </choice>
    <choice id="safari" title="SU_SAFARI" description="SU_SAFARI" start_selected="pm_safari_selected()">
        <pkg-ref id="ee.ria.esteidfirefoxplugin">firefox-token-signing.pkg</pkg-ref>
    </choice>
    <choice id="firefox" title="SU_FIREFOX" description="SU_FIREFOX" start_selected="pm_firefox_selected()">
        <pkg-ref id="ee.ria.esteidfirefoxplugin">firefox-token-signing.pkg</pkg-ref>
        <pkg-ref id="ee.ria.esteidpkcs11loader">firefox-pkcs11-loader.pkg</pkg-ref>
    </choice>
    <choice id="chrome" title="SU_CHROME" description="SU_CHROME" start_selected="pm_chrome_selected()">
        <pkg-ref id="ee.ria.chrome-token-signing">chrome-token-signing.pkg</pkg-ref>
    </choice>
    <choice id="drivers1010" title="SU_DRIVERSNEW" description="SU_DRIVERSNEW" start_selected="pm_drivers1010_selected()" start_enabled="pm_drivers1010_enabled()">
        <pkg-ref id="ee.ria.esteid-pkcs11">esteid-pkcs11.pkg</pkg-ref>
        <pkg-ref id="ee.ria.esteid-tokend">esteid-tokend.pkg</pkg-ref>
    </choice>
    <choice id="driversold" title="SU_DRIVERSOLD" description="SU_DRIVERSOLD" start_selected="pm_driversold_selected()" start_enabled="pm_driversold_enabled()">
        <pkg-ref id="ee.ria.esteid-pkcs11-old">esteid-pkcs11-old.pkg</pkg-ref>
        <pkg-ref id="ee.ria.esteid-tokend-old">esteid-tokend-old.pkg</pkg-ref>
    </choice>
</installer-gui-script>
